# Active Context

## Текущая цель
Реализовать генерацию PDF билетов в методе `GetTicketsV1RequestHandler.GenerateDocument(int personsCount, DateTimeOffset visitDate)` с использованием `PDFsharp`, стилизуя документ под `template.pdf`. На вход: количество билетов и дата посещения; на выход: поток PDF с указанным количеством билетов, датой, сгенерированным номером заказа и штрихкодом.

## Входы/Выходы
- Вход: `personsCount` (int), `visitDate` (DateTimeOffset).
- Выход: `Stream` PDF; в ответе API — `FileStream`, `ContentType`, `DownloadFileName`.

## Дизайн решения (набросок)
- Разметка страницы и сетка билетов по образцу шаблона.
- Встраивание/подключение шрифтов, единые отступы и размеры.
- Генерация orderId (например, ULID/Guid, форматируемый для печати).
- Генерация штрихкода (например, Code128 через ZXing) и отрисовка как изображения.
- Пагинация при большом количестве билетов.

## Следующие шаги
1. Проанализировать `template.pdf` (размеры, поля, шрифты).
2. Подготовить утилиты рендеринга: шрифты, палитра, размеры, функции рисования блока билета.
3. Добавить зависимость для штрихкодов (например, ZXing.Net) при необходимости.
4. Реализовать `GenerateDocument` с заполнением данных и возвратом MemoryStream.
5. Обновить `HandleCore` для вызова `GenerateDocument` вместо возвращения ресурса.
